<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªÜ TH·ªêNG V·ªÜ TINH QUY HO·∫†CH BA V√å 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #FFD700; --deep-blue: #000428; --neon-blue: #00d2ff; }
        body { 
            font-family: 'Montserrat', sans-serif; 
            background: linear-gradient(135deg, #004e92, #000428); 
            color: white; margin: 0; padding: 0; 
            min-height: 100vh; overflow-x: hidden;
        }
        
        /* Hi·ªáu ·ª©ng Radar V·ªá Tinh */
        .radar-container {
            position: relative; width: 120px; height: 120px; margin: 30px auto;
            border: 2px solid var(--gold); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }
        .radar-sweep {
            position: absolute; width: 100%; height: 100%;
            border-radius: 50%; border-top: 3px solid var(--gold);
            animation: rotate 2s linear infinite;
        }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .radar-icon { font-size: 40px; filter: drop-shadow(0 0 10px var(--gold)); }

        .header-text { text-align: center; padding: 0 20px; }
        .header-text h1 { 
            font-weight: 900; font-size: 28px; margin: 0;
            background: linear-gradient(to right, #fff, var(--gold), #fff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-transform: uppercase; letter-spacing: 2px;
        }
        .header-text p { font-size: 10px; color: var(--neon-blue); letter-spacing: 4px; font-weight: bold; margin-top: 5px; }

        /* Khung t√¨m ki·∫øm */
        .search-section { max-width: 450px; margin: 30px auto; padding: 0 20px; }
        .search-group { position: relative; display: flex; align-items: center; }
        input { 
            width: 100%; padding: 20px 25px; border-radius: 50px; 
            border: 1px solid rgba(255, 215, 0, 0.5); background: rgba(255, 255, 255, 0.05);
            color: white; font-size: 16px; outline: none; backdrop-filter: blur(5px);
            transition: 0.3s;
        }
        input:focus { border-color: var(--gold); box-shadow: 0 0 20px rgba(255, 215, 0, 0.2); }
        .btn-scan { 
            position: absolute; right: 8px; background: var(--gold); 
            color: #000; border: none; padding: 12px 25px; border-radius: 40px;
            font-weight: 900; cursor: pointer; transition: 0.2s;
        }
        .btn-scan:active { transform: scale(0.95); }

        /* Th·∫ª K·∫øt Qu·∫£ Luxury */
        .result-card { 
            display: none; max-width: 420px; margin: 0 auto 50px;
            background: white; color: #333; border-radius: 35px;
            padding: 30px; box-shadow: 0 30px 60px rgba(0,0,0,0.5);
            animation: slideIn 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }

        .location-title { font-size: 22px; font-weight: 900; color: #1a237e; margin-bottom: 10px; display: flex; align-items: center; }
        .price-box { 
            background: linear-gradient(135deg, #fff4e5, #fffbf2);
            padding: 20px; border-radius: 20px; border-left: 6px solid #ff9800;
            margin-bottom: 20px;
        }
        .price-box small { font-weight: bold; color: #666; text-transform: uppercase; font-size: 11px; }
        .price-box b { font-size: 32px; color: #e65100; display: block; margin-top: 5px; }

        /* V√πng Quy Ho·∫°ch B·ªã Kh√≥a */
        .planning-lock { position: relative; border-radius: 20px; overflow: hidden; margin-bottom: 20px; border: 1px solid #ff4444; }
        .blur-content { filter: blur(10px); background: #eee; padding: 20px; font-size: 12px; color: #777; line-height: 1.6; }
        .lock-overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: center;
        }
        .lock-badge { 
            background: #ff4444; color: white; padding: 10px 20px; border-radius: 50px;
            font-weight: 900; font-size: 11px; border: 2px solid white;
            box-shadow: 0 5px 15px rgba(255, 68, 68, 0.4); animation: shake 2s infinite;
        }
        @keyframes shake { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

        /* Khu V·ª±c QR */
        .qr-section { 
            background: #f0f7ff; border: 2px dashed #004e92; border-radius: 25px;
            padding: 25px; text-align: center; cursor: pointer;
        }
        .qr-wrapper { 
            width: 200px; height: 200px; background: white; margin: 0 auto 15px;
            padding: 10px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center;
        }
        .qr-wrapper img { width: 100%; height: 100%; border-radius: 10px; }
        .payment-text { font-size: 14px; font-weight: 900; color: #0d47a1; margin: 0 0 10px 0; }
        .status-text { font-size: 11px; color: #f57c00; font-weight: bold; }

        /* Th√¥ng b√°o ·∫£o */
        #toast { 
            position: fixed; bottom: 20px; left: 20px; background: rgba(0,0,0,0.9);
            color: var(--gold); padding: 15px 25px; border-radius: 15px;
            display: none; font-size: 13px; font-weight: bold; border-left: 5px solid var(--gold);
            z-index: 9999; box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>

    <div class="radar-container">
        <div class="radar-sweep"></div>
        <div class="radar-icon">üõ∞Ô∏è</div>
    </div>

    <div class="header-text">
        <h1>Ba Vi Luxury Land</h1>
        <p>REAL-TIME SATELLITE ANALYTICS 2026</p>
    </div>

    <div class="search-section">
        <div class="search-group">
            <input type="text" id="citySearch" placeholder="Nh·∫≠p t√™n khu v·ª±c (VD: T√¢y ƒê·∫±ng)...">
            <button class="btn-scan" onclick="performScan()">QU√âT</button>
        </div>
        <div id="loader" style="display:none; text-align:center; margin-top:15px; color:var(--gold); font-weight:bold; font-size:13px;">
            üì° ƒêANG K·∫æT N·ªêI V·ªÜ TINH T·∫¶NG TH·∫§P...
        </div>
    </div>

    <div id="resultCard" class="result-card">
        <div class="location-title">üìç <span id="locName"></span></div>
        
        <div class="price-box">
            <small>D·ª± ƒëo√°n gi√° ƒë·∫•t Qu√Ω 1/2026</small>
            <b id="locPrice"></b>
        </div>

        <div style="background:#000; color:var(--gold); padding:5px 12px; border-radius:6px; font-size:11px; font-weight:900; display:inline-block; margin-bottom:12px;">D·ªÆ LI·ªÜU QUY HO·∫†CH CHI TI·∫æT</div>

        <div class="planning-lock">
            <div class="lock-overlay"><div class="lock-badge">üîí CH·∫†M QR ƒê·ªÇ GI·∫¢I M√É</div></div>
            <div class="blur-content">
                ‚ö†Ô∏è C·∫¢NH B√ÅO: Th·ª≠a ƒë·∫•t c√≥ d·∫•u hi·ªáu n·∫±m trong quy ho·∫°ch h√†nh lang xanh giao th√¥ng m·ªü r·ªông. T·ªça ƒë·ªô VN-2000: X: 593.4xx - Y: 2.341.9xx. VƒÉn b·∫£n ngƒÉn ch·∫∑n giao d·ªãch ƒëang ƒë∆∞·ª£c c·∫≠p nh·∫≠t...
            </div>
        </div>

        <div class="qr-section" id="qrClickArea" onclick="confirmPayment()">
            <p class="payment-text">‚òï M·ªúI TR√Ä ƒê√Å 5K ƒê·ªÇ XEM T·ªåA ƒê·ªò</p>
            <div class="qr-wrapper">
                <img id="qrMain" src="" alt="M√£ QR">
            </div>
            <div class="status-text">‚è≥ <span id="countdown">05:00</span> - ƒêang ch·ªù t√≠n hi·ªáu chuy·ªÉn kho·∫£n...</div>
        </div>

        <button onclick="location.reload()" style="width:100%; border:none; background:#f5f5f5; padding:15px; border-radius:15px; margin-top:20px; font-weight:bold; color:#888; cursor:pointer;">‚úñ ƒê√ìNG B√ÅO C√ÅO</button>
    </div>

    <div id="toast">üîî <span id="toastMsg"></span></div>

    <script>
        // C√†i ƒë·∫∑t √¢m thanh
        const sfxTing = new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3');
        const sfxScan = new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3');

        async function performScan() {
            const input = document.getElementById('citySearch').value;
            if(!input) return;

            sfxScan.play().catch(() => {});
            document.getElementById('loader').style.display = 'block';
            document.getElementById('resultCard').style.display = 'none';

            try {
                const response = await fetch('/api/search?q=' + encodeURIComponent(input));
                const data = await response.json();

                setTimeout(() => {
                    document.getElementById('loader').style.display = 'none';
                    if(data && data.length > 0) {
                        confetti({ particleCount: 150, spread: 70, origin: { y: 0.7 }, colors: ['#FFD700', '#ffffff', '#00d2ff'] });
                        
                        const item = data[0];
                        document.getElementById('locName').innerText = item.duong;
                        document.getElementById('locPrice').innerText = item.gia_2026_du_kien.toLocaleString() + " ƒë/m¬≤";
                        
                        // C·∫≠p nh·∫≠t QR v·ªõi cache busting ƒë·ªÉ tr√°nh l·ªói tr·∫Øng ·∫£nh
                        const qrUrl = "https://img.vietqr.io/image/LPB-033963180001-compact.jpg?amount=5000&addInfo=MoKhoa_" + encodeURIComponent(item.duong) + "&t=" + new Date().getTime();
                        document.getElementById('qrMain').src = qrUrl;

                        document.getElementById('resultCard').style.display = 'block';
                        startTimer();
                    } else {
                        alert("V·ªá tinh kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu t·∫°i khu v·ª±c n√†y!");
                    }
                }, 1500);
            } catch (err) {
                alert("L·ªói k·∫øt n·ªëi m√°y ch·ªß v·ªá tinh!");
                document.getElementById('loader').style.display = 'none';
            }
        }

        function confirmPayment() {
            const area = document.getElementById('qrClickArea');
            if(area.innerHTML.includes('C·∫¢M ∆†N')) return;

            area.innerHTML = `<div style="padding:20px; font-weight:bold; color:#0d47a1;">üì° ƒêang truy v·∫•n ng√¢n h√†ng...</div>`;
            
            setTimeout(() => {
                sfxTing.play().catch(() => {});
                confetti({ particleCount: 100, spread: 60, colors: ['#2e7d32', '#FFD700'] });
                
                area.innerHTML = `
                    <div style="background:#e8f5e9; border:2px solid #2e7d32; padding:20px; border-radius:20px;">
                        <h3 style="color:#1b5e20; margin:0;">‚úÖ C·∫¢M ∆†N B·∫†N!</h3>
                        <p style="font-size:13px; margin:10px 0;">ƒê√£ x√°c nh·∫≠n 5.000ƒë. H·ªá th·ªëng ƒë√£ gi·∫£i m√£ d·ªØ li·ªáu quy ho·∫°ch.</p>
                    </div>`;
                
                document.querySelector('.blur-content').style.filter = "none";
                document.querySelector('.lock-overlay').style.display = "none";
            }, 3000);
        }

        function startTimer() {
            let t = 300;
            const timer = document.getElementById('countdown');
            const interval = setInterval(() => {
                t--;
                let m = Math.floor(t/60), s = t%60;
                timer.innerText = (m < 10 ? '0' : '') + m + ':' + (s < 10 ? '0' : '') + s;
                if(t <= 0) clearInterval(interval);
            }, 1000);
        }

        // Th√¥ng b√°o kh√°ch h√†ng ·∫£o
        setInterval(() => {
            const names = ["Anh H√πng", "Ch·ªã Th·∫£o", "BƒêS Ba V√¨", "Anh Tu·∫•n", "Ch·ªã Lan", "Kh√°ch ·∫©n danh"];
            const areas = ["T√¢y ƒê·∫±ng", "Ph√∫ H·ªØu", "V√¢n Sa", "Nhu·∫≠n Tr·∫°ch", "Th·ª•y An", "C·ªï ƒê√¥"];
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').innerText = names[Math.floor(Math.random()*names.length)] + " v·ª´a m·ªü kh√≥a quy ho·∫°ch t·∫°i " + areas[Math.floor(Math.random()*areas.length)];
            toast.style.display = 'block';
            setTimeout(() => { toast.style.display = 'none'; }, 5000);
        }, 25000);
    </script>
</body>
</html>
